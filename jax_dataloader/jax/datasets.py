# AUTOGENERATED! DO NOT EDIT! File to edit: ../../nbs/jax.dataset.ipynb.

# %% ../../nbs/jax.dataset.ipynb 3
from __future__ import print_function, division, annotations
from ..imports import *
from ..datasets import Dataset

# %% auto 0
__all__ = ['ArrayDataset']

# %% ../../nbs/jax.dataset.ipynb 4
class ArrayDataset(Dataset):
    """Dataset wrapping numpy arrays."""

    def __init__(
        self, 
        *arrays: jnp.DeviceArray # Numpy array with same first dimension
    ):
        assert all(arrays[0].shape[0] == arr.shape[0] for arr in arrays), \
            "All arrays must have the same dimension."
        self.arrays = tuple(arrays)

    def __len__(self):
        return self.arrays[0].shape[0]

    def __getitem__(self, index):
        return jax.tree_util.tree_map(lambda x: x[index], self.arrays)
